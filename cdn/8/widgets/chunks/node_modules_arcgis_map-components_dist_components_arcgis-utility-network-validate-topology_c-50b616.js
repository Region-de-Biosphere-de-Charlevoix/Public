"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["node_modules_arcgis_map-components_dist_components_arcgis-utility-network-validate-topology_c-50b616"],{

/***/ "./node_modules/@arcgis/map-components/dist/chunks/component-utils.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/chunks/component-utils.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ p),
/* harmony export */   b: () => (/* binding */ P),
/* harmony export */   c: () => (/* binding */ H),
/* harmony export */   d: () => (/* binding */ L),
/* harmony export */   e: () => (/* binding */ O),
/* harmony export */   f: () => (/* binding */ x),
/* harmony export */   i: () => (/* binding */ N),
/* harmony export */   p: () => (/* binding */ u),
/* harmony export */   r: () => (/* binding */ S)
/* harmony export */ });
/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.1 */
function P(e, i) {
  Array.isArray(i) ? e._watchHandles = [...e._watchHandles, ...i] : e._watchHandles.push(i);
}
function p(e) {
  e.el.childElem && (e.el.childElem.ownedBy = e.el);
  const i = h(e);
  if (!i) {
    const t = y(e.referenceElement);
    if (!t) {
      g(e);
      return;
    }
    return f(t, e, !0), t;
  }
  return w(i, e.el.parent) || (e.el.parent = i, i.tagName.toLowerCase() === "arcgis-expand" ? v(i, e) : i.tagName.toLowerCase() === "arcgis-placement" ? C(i, e) : f(i, e, !1)), i;
}
function h({ el: e }) {
  for (let i = e.parentElement; i; i = i?.parentElement ?? null) {
    if (c.has(i.tagName.toLowerCase()))
      return i;
    if ("ownedBy" in i && i.ownedBy instanceof HTMLElement && c.has(i.ownedBy.tagName.toLowerCase()))
      return i.ownedBy;
  }
}
const c = /* @__PURE__ */ new Set([
  "arcgis-map",
  "arcgis-scene",
  "arcgis-link-chart",
  "arcgis-expand",
  "arcgis-placement"
]);
function w(e, i) {
  if (e !== i)
    return !1;
  const t = e.tagName.toLowerCase();
  return t === "arcgis-expand" || t === "arcgis-placement";
}
function l(e, i, t = "arcgisReady") {
  const r = e;
  if (typeof r.view?.ready == "boolean")
    i(r.view);
  else {
    let s = function(d) {
      d.target === e && (l(e, i, t), e.removeEventListener(t, s));
    };
    e.addEventListener(t, s);
  }
}
const v = (e, i) => l(e, (t) => {
  i.el.childElem && e.content != null && e.content.append(i.el.childElem), e.expandIcon = i.icon || i.widget?.icon || e.expandIcon, i.position = e.position, i.el.view = t;
}), C = (e, i) => l(e, (t) => {
  i.el.childElem && i.el.append(i.el.childElem), i.position = e.position, i.el.view = t;
}), f = (e, i, t) => l(
  e,
  (r) => {
    t ? g(i) : i.el.childElem && E(e, i), i.el.view = r;
  },
  "arcgisViewReadyChange"
);
function E(e, i) {
  const t = i.el.childElem ?? i.el, r = [...e.children], s = {};
  for (const a of r) {
    const n = a.getAttribute("position") ?? "manual";
    s[n] ??= [], s[n].push({ child: a, position: n, index: r.indexOf(a) });
  }
  const d = s[i.position ?? "manual"]?.findIndex(({ child: a }) => a === i.el), o = e.view.ui;
  o.remove(t), o.add(t, { position: i.position, index: d });
}
function L(e) {
  let i = !1, t = e.el.view;
  const r = Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e.el), "view") ?? {
    get: () => t,
    set: (s) => t = s
  };
  Object.defineProperty(e.el, "view", {
    get: r.get.bind(e.el),
    set: (s) => {
      r.set.call(e.el, s), s && !i && (i = !0, e.arcgisReady.emit());
    },
    configurable: !0,
    enumerable: !0
  }), t && (e.el.view = t);
}
function x(e) {
  return e == null || e === "";
}
function H(e, i) {
  return i != null && e?.position === i.position && e?.heading === i.heading && e?.tilt === i.tilt && e?.fov === i.fov;
}
function N(e, i) {
  return i === void 0 || e?.targetGeometry !== i?.targetGeometry || e?.rotation !== i?.rotation || e?.scale !== i?.scale;
}
function O(e, i) {
  return u(i?.center, e);
}
function u(e, i) {
  if (typeof i == "string")
    return u(e, i.split(",").map(Number));
  if (!e)
    return i;
  if (Array.isArray(i)) {
    const t = i[0], r = i[1], s = i.length > 2 ? i[2] : void 0;
    if (t !== e.longitude || r !== e.latitude || s !== e.z)
      return i;
  } else if (i && !e?.equals(i))
    return i;
}
async function S(e, i) {
  i != null && (typeof i == "string" ? e.el.view = await b(i) : e.widget && (e.el.view = i.view));
}
async function b(e) {
  const i = y(e);
  return await new Promise((t) => {
    typeof i?.view?.ready == "boolean" ? t(i.view) : i && i.addEventListener("arcgisViewReadyChange", () => t(i.view), { once: !0 });
  });
}
function g(e) {
  e.el.childElem && (e.el.shadowRoot ?? e.el).append(e.el.childElem);
}
function y(e) {
  return typeof e != "string" ? e ?? void 0 : (e.includes("#") || e.includes(".") || e.includes("[") ? void 0 : document.querySelector(`#${e}`)) ?? document.querySelector(e) ?? void 0;
}



/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/chunks/disconnected.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/chunks/disconnected.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   o: () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _arcgis_components_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @arcgis/components-utils */ "./node_modules/@arcgis/components-utils/dist/index.js");

/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.1 */
function a(i) {
  i.el.childElem ? i.el.isConnected || (i.view?.ui ? i.view.ui.remove(i.el.childElem) : i.widget?.view && i.widget.view.ui.remove(i.el.childElem), i._watchHandles && i._watchHandles.forEach((o) => {
    o.remove();
  }), i._watchHandles = [], i.widget?.destroy()) : (0,_arcgis_components_utils__WEBPACK_IMPORTED_MODULE_0__.devToolsAwareTimeout)(() => {
    i.el.isConnected || (i.view?.ui ? i.view.ui.remove(i.el) : i.widget?.view && i.widget.view.ui.remove(i.el), i._watchHandles && i._watchHandles.forEach((o) => {
      o.remove();
    }), i._watchHandles = [], i.widget?.destroy());
  }, 1e3);
}



/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/components/arcgis-utility-network-validate-topology/customElement.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/components/arcgis-utility-network-validate-topology/customElement.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ArcgisUtilityNetworkValidateTopology: () => (/* binding */ m)
/* harmony export */ });
/* harmony import */ var _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chunks/runtime.js */ "./node_modules/@arcgis/map-components/dist/chunks/runtime.js");
/* harmony import */ var lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/ref.js */ "./node_modules/lit-html/development/directives/ref.js");
/* harmony import */ var _arcgis_core_widgets_UtilityNetworkValidateTopology_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @arcgis/core/widgets/UtilityNetworkValidateTopology.js */ "@arcgis/core/widgets/UtilityNetworkValidateTopology.js");
/* harmony import */ var _chunks_component_utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../chunks/component-utils.js */ "./node_modules/@arcgis/map-components/dist/chunks/component-utils.js");
/* harmony import */ var _chunks_disconnected_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../chunks/disconnected.js */ "./node_modules/@arcgis/map-components/dist/chunks/disconnected.js");
/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! lit */ "./node_modules/lit/index.js");
/* harmony import */ var _arcgis_lumina__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @arcgis/lumina */ "./node_modules/@arcgis/lumina/dist/index.js");







/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.1 */
class m extends _arcgis_lumina__WEBPACK_IMPORTED_MODULE_6__.LitElement {
  constructor() {
    super(...arguments), this._watchHandles = [], this.extentToValidate = "current", this.position = "bottom-left", this.arcgisReady = (0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_6__.createEvent)();
  }
  static {
    this.properties = { extentToValidate: 1, position: 1, referenceElement: 1, utilityNetwork: 0, view: 0, widget: 0 };
  }
  static {
    this.shadowRootOptions = _arcgis_lumina__WEBPACK_IMPORTED_MODULE_6__.noShadowRoot;
  }
  // #endregion
  // #region Lifecycle
  willUpdate(t) {
    t.has("referenceElement") && this.referenceElementWatcher(this.referenceElement), t.has("extentToValidate") && this.extentToValidateWatcher(this.extentToValidate), t.has("utilityNetwork") && this.utilityNetworkWatcher(this.utilityNetwork), t.has("position") && this.positionWatcher(this.position), t.has("view") && this.viewWatcher(this.view);
  }
  async loaded() {
    const t = this._createParams(), i = new _arcgis_core_widgets_UtilityNetworkValidateTopology_js__WEBPACK_IMPORTED_MODULE_2__["default"](t);
    this.widget = i, this._addContainer(), (0,_chunks_component_utils_js__WEBPACK_IMPORTED_MODULE_3__.d)(this), (0,_chunks_component_utils_js__WEBPACK_IMPORTED_MODULE_3__.a)(this);
  }
  disconnectedCallback() {
    super.disconnectedCallback(), (0,_chunks_disconnected_js__WEBPACK_IMPORTED_MODULE_4__.o)(this);
  }
  // #endregion
  // #region Private Methods
  referenceElementWatcher(t) {
    (0,_chunks_component_utils_js__WEBPACK_IMPORTED_MODULE_3__.r)(this, t);
  }
  extentToValidateWatcher(t) {
    this.widget && (this.widget.extentToValidate = t);
  }
  utilityNetworkWatcher(t) {
    this.widget && t && (this.widget.utilityNetwork = t);
  }
  positionWatcher(t) {
    t !== void 0 && this.widget && this.el.childElem && this.view.ui?.move(this.el.childElem, t);
  }
  viewWatcher(t) {
    t !== void 0 && this.widget && (this.widget.view = t, this._loadUtilityNetwork());
  }
  _addContainer() {
    this.widget.container = this.el.childElem;
  }
  _createParams() {
    const t = {};
    return this.extentToValidate !== void 0 && (t.extentToValidate = this.extentToValidate), this.utilityNetwork !== void 0 && (t.utilityNetwork = this.utilityNetwork), t;
  }
  async _loadUtilityNetwork() {
    if (this.view?.map && this.view.map.portalItem) {
      await this.view.map.load();
      const t = this.view.map.utilityNetworks?.getItemAt(0);
      await t?.load(), this.utilityNetwork = t;
    }
  }
  _setChildElement(t) {
    this.el.childElem = t;
  }
  // #endregion
  // #region Rendering
  render() {
    return (0,lit__WEBPACK_IMPORTED_MODULE_5__.html)`<div ${(0,lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_1__.ref)(this._setChildElement)}></div>`;
  }
}
(0,_chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.c)("arcgis-utility-network-validate-topology", m);



/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3Mvbm9kZV9tb2R1bGVzX2FyY2dpc19tYXAtY29tcG9uZW50c19kaXN0X2NvbXBvbmVudHNfYXJjZ2lzLXV0aWxpdHktbmV0d29yay12YWxpZGF0ZS10b3BvbG9neV9jLTUwYjYxNi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixnQ0FBZ0MsR0FBRztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsNENBQTRDO0FBQ3pFO0FBQ0Esb0RBQW9ELFVBQVU7QUFDOUQsMEJBQTBCLGdDQUFnQztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlIQUF5SCxVQUFVO0FBQ25JLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMklBQTJJLEVBQUU7QUFDN0k7QUFXRTs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZJbUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnREFBZ0QsOEVBQUM7QUFDcEQ7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFHRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2YrQztBQUNLO0FBQ2lCO0FBQ0U7QUFDbkI7QUFDdEI7QUFDc0Q7QUFDdEY7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHNEQUFDO0FBQ2pCO0FBQ0EsdUlBQXVJLDJEQUFDO0FBQ3hJO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLDZCQUE2Qix3REFBQztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0Qyw4RkFBQztBQUM3QywyQ0FBMkMsNkRBQUMsUUFBUSw2REFBQztBQUNyRDtBQUNBO0FBQ0Esa0NBQWtDLDBEQUFDO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSw2REFBQztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcseUNBQUMsUUFBUSwrREFBQyx3QkFBd0I7QUFDN0M7QUFDQTtBQUNBLHFEQUFDO0FBR0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9jaHVua3MvY29tcG9uZW50LXV0aWxzLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2NodW5rcy9kaXNjb25uZWN0ZWQuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL21hcC1jb21wb25lbnRzL2Rpc3QvY29tcG9uZW50cy9hcmNnaXMtdXRpbGl0eS1uZXR3b3JrLXZhbGlkYXRlLXRvcG9sb2d5L2N1c3RvbUVsZW1lbnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzIvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxudjQuMzIuMSAqL1xuZnVuY3Rpb24gUChlLCBpKSB7XG4gIEFycmF5LmlzQXJyYXkoaSkgPyBlLl93YXRjaEhhbmRsZXMgPSBbLi4uZS5fd2F0Y2hIYW5kbGVzLCAuLi5pXSA6IGUuX3dhdGNoSGFuZGxlcy5wdXNoKGkpO1xufVxuZnVuY3Rpb24gcChlKSB7XG4gIGUuZWwuY2hpbGRFbGVtICYmIChlLmVsLmNoaWxkRWxlbS5vd25lZEJ5ID0gZS5lbCk7XG4gIGNvbnN0IGkgPSBoKGUpO1xuICBpZiAoIWkpIHtcbiAgICBjb25zdCB0ID0geShlLnJlZmVyZW5jZUVsZW1lbnQpO1xuICAgIGlmICghdCkge1xuICAgICAgZyhlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIGYodCwgZSwgITApLCB0O1xuICB9XG4gIHJldHVybiB3KGksIGUuZWwucGFyZW50KSB8fCAoZS5lbC5wYXJlbnQgPSBpLCBpLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJhcmNnaXMtZXhwYW5kXCIgPyB2KGksIGUpIDogaS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwiYXJjZ2lzLXBsYWNlbWVudFwiID8gQyhpLCBlKSA6IGYoaSwgZSwgITEpKSwgaTtcbn1cbmZ1bmN0aW9uIGgoeyBlbDogZSB9KSB7XG4gIGZvciAobGV0IGkgPSBlLnBhcmVudEVsZW1lbnQ7IGk7IGkgPSBpPy5wYXJlbnRFbGVtZW50ID8/IG51bGwpIHtcbiAgICBpZiAoYy5oYXMoaS50YWdOYW1lLnRvTG93ZXJDYXNlKCkpKVxuICAgICAgcmV0dXJuIGk7XG4gICAgaWYgKFwib3duZWRCeVwiIGluIGkgJiYgaS5vd25lZEJ5IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgJiYgYy5oYXMoaS5vd25lZEJ5LnRhZ05hbWUudG9Mb3dlckNhc2UoKSkpXG4gICAgICByZXR1cm4gaS5vd25lZEJ5O1xuICB9XG59XG5jb25zdCBjID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoW1xuICBcImFyY2dpcy1tYXBcIixcbiAgXCJhcmNnaXMtc2NlbmVcIixcbiAgXCJhcmNnaXMtbGluay1jaGFydFwiLFxuICBcImFyY2dpcy1leHBhbmRcIixcbiAgXCJhcmNnaXMtcGxhY2VtZW50XCJcbl0pO1xuZnVuY3Rpb24gdyhlLCBpKSB7XG4gIGlmIChlICE9PSBpKVxuICAgIHJldHVybiAhMTtcbiAgY29uc3QgdCA9IGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICByZXR1cm4gdCA9PT0gXCJhcmNnaXMtZXhwYW5kXCIgfHwgdCA9PT0gXCJhcmNnaXMtcGxhY2VtZW50XCI7XG59XG5mdW5jdGlvbiBsKGUsIGksIHQgPSBcImFyY2dpc1JlYWR5XCIpIHtcbiAgY29uc3QgciA9IGU7XG4gIGlmICh0eXBlb2Ygci52aWV3Py5yZWFkeSA9PSBcImJvb2xlYW5cIilcbiAgICBpKHIudmlldyk7XG4gIGVsc2Uge1xuICAgIGxldCBzID0gZnVuY3Rpb24oZCkge1xuICAgICAgZC50YXJnZXQgPT09IGUgJiYgKGwoZSwgaSwgdCksIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LCBzKSk7XG4gICAgfTtcbiAgICBlLmFkZEV2ZW50TGlzdGVuZXIodCwgcyk7XG4gIH1cbn1cbmNvbnN0IHYgPSAoZSwgaSkgPT4gbChlLCAodCkgPT4ge1xuICBpLmVsLmNoaWxkRWxlbSAmJiBlLmNvbnRlbnQgIT0gbnVsbCAmJiBlLmNvbnRlbnQuYXBwZW5kKGkuZWwuY2hpbGRFbGVtKSwgZS5leHBhbmRJY29uID0gaS5pY29uIHx8IGkud2lkZ2V0Py5pY29uIHx8IGUuZXhwYW5kSWNvbiwgaS5wb3NpdGlvbiA9IGUucG9zaXRpb24sIGkuZWwudmlldyA9IHQ7XG59KSwgQyA9IChlLCBpKSA9PiBsKGUsICh0KSA9PiB7XG4gIGkuZWwuY2hpbGRFbGVtICYmIGkuZWwuYXBwZW5kKGkuZWwuY2hpbGRFbGVtKSwgaS5wb3NpdGlvbiA9IGUucG9zaXRpb24sIGkuZWwudmlldyA9IHQ7XG59KSwgZiA9IChlLCBpLCB0KSA9PiBsKFxuICBlLFxuICAocikgPT4ge1xuICAgIHQgPyBnKGkpIDogaS5lbC5jaGlsZEVsZW0gJiYgRShlLCBpKSwgaS5lbC52aWV3ID0gcjtcbiAgfSxcbiAgXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIlxuKTtcbmZ1bmN0aW9uIEUoZSwgaSkge1xuICBjb25zdCB0ID0gaS5lbC5jaGlsZEVsZW0gPz8gaS5lbCwgciA9IFsuLi5lLmNoaWxkcmVuXSwgcyA9IHt9O1xuICBmb3IgKGNvbnN0IGEgb2Ygcikge1xuICAgIGNvbnN0IG4gPSBhLmdldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIpID8/IFwibWFudWFsXCI7XG4gICAgc1tuXSA/Pz0gW10sIHNbbl0ucHVzaCh7IGNoaWxkOiBhLCBwb3NpdGlvbjogbiwgaW5kZXg6IHIuaW5kZXhPZihhKSB9KTtcbiAgfVxuICBjb25zdCBkID0gc1tpLnBvc2l0aW9uID8/IFwibWFudWFsXCJdPy5maW5kSW5kZXgoKHsgY2hpbGQ6IGEgfSkgPT4gYSA9PT0gaS5lbCksIG8gPSBlLnZpZXcudWk7XG4gIG8ucmVtb3ZlKHQpLCBvLmFkZCh0LCB7IHBvc2l0aW9uOiBpLnBvc2l0aW9uLCBpbmRleDogZCB9KTtcbn1cbmZ1bmN0aW9uIEwoZSkge1xuICBsZXQgaSA9ICExLCB0ID0gZS5lbC52aWV3O1xuICBjb25zdCByID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPYmplY3QuZ2V0UHJvdG90eXBlT2YoZS5lbCksIFwidmlld1wiKSA/PyB7XG4gICAgZ2V0OiAoKSA9PiB0LFxuICAgIHNldDogKHMpID0+IHQgPSBzXG4gIH07XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLmVsLCBcInZpZXdcIiwge1xuICAgIGdldDogci5nZXQuYmluZChlLmVsKSxcbiAgICBzZXQ6IChzKSA9PiB7XG4gICAgICByLnNldC5jYWxsKGUuZWwsIHMpLCBzICYmICFpICYmIChpID0gITAsIGUuYXJjZ2lzUmVhZHkuZW1pdCgpKTtcbiAgICB9LFxuICAgIGNvbmZpZ3VyYWJsZTogITAsXG4gICAgZW51bWVyYWJsZTogITBcbiAgfSksIHQgJiYgKGUuZWwudmlldyA9IHQpO1xufVxuZnVuY3Rpb24geChlKSB7XG4gIHJldHVybiBlID09IG51bGwgfHwgZSA9PT0gXCJcIjtcbn1cbmZ1bmN0aW9uIEgoZSwgaSkge1xuICByZXR1cm4gaSAhPSBudWxsICYmIGU/LnBvc2l0aW9uID09PSBpLnBvc2l0aW9uICYmIGU/LmhlYWRpbmcgPT09IGkuaGVhZGluZyAmJiBlPy50aWx0ID09PSBpLnRpbHQgJiYgZT8uZm92ID09PSBpLmZvdjtcbn1cbmZ1bmN0aW9uIE4oZSwgaSkge1xuICByZXR1cm4gaSA9PT0gdm9pZCAwIHx8IGU/LnRhcmdldEdlb21ldHJ5ICE9PSBpPy50YXJnZXRHZW9tZXRyeSB8fCBlPy5yb3RhdGlvbiAhPT0gaT8ucm90YXRpb24gfHwgZT8uc2NhbGUgIT09IGk/LnNjYWxlO1xufVxuZnVuY3Rpb24gTyhlLCBpKSB7XG4gIHJldHVybiB1KGk/LmNlbnRlciwgZSk7XG59XG5mdW5jdGlvbiB1KGUsIGkpIHtcbiAgaWYgKHR5cGVvZiBpID09IFwic3RyaW5nXCIpXG4gICAgcmV0dXJuIHUoZSwgaS5zcGxpdChcIixcIikubWFwKE51bWJlcikpO1xuICBpZiAoIWUpXG4gICAgcmV0dXJuIGk7XG4gIGlmIChBcnJheS5pc0FycmF5KGkpKSB7XG4gICAgY29uc3QgdCA9IGlbMF0sIHIgPSBpWzFdLCBzID0gaS5sZW5ndGggPiAyID8gaVsyXSA6IHZvaWQgMDtcbiAgICBpZiAodCAhPT0gZS5sb25naXR1ZGUgfHwgciAhPT0gZS5sYXRpdHVkZSB8fCBzICE9PSBlLnopXG4gICAgICByZXR1cm4gaTtcbiAgfSBlbHNlIGlmIChpICYmICFlPy5lcXVhbHMoaSkpXG4gICAgcmV0dXJuIGk7XG59XG5hc3luYyBmdW5jdGlvbiBTKGUsIGkpIHtcbiAgaSAhPSBudWxsICYmICh0eXBlb2YgaSA9PSBcInN0cmluZ1wiID8gZS5lbC52aWV3ID0gYXdhaXQgYihpKSA6IGUud2lkZ2V0ICYmIChlLmVsLnZpZXcgPSBpLnZpZXcpKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGIoZSkge1xuICBjb25zdCBpID0geShlKTtcbiAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlKCh0KSA9PiB7XG4gICAgdHlwZW9mIGk/LnZpZXc/LnJlYWR5ID09IFwiYm9vbGVhblwiID8gdChpLnZpZXcpIDogaSAmJiBpLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgKCkgPT4gdChpLnZpZXcpLCB7IG9uY2U6ICEwIH0pO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGcoZSkge1xuICBlLmVsLmNoaWxkRWxlbSAmJiAoZS5lbC5zaGFkb3dSb290ID8/IGUuZWwpLmFwcGVuZChlLmVsLmNoaWxkRWxlbSk7XG59XG5mdW5jdGlvbiB5KGUpIHtcbiAgcmV0dXJuIHR5cGVvZiBlICE9IFwic3RyaW5nXCIgPyBlID8/IHZvaWQgMCA6IChlLmluY2x1ZGVzKFwiI1wiKSB8fCBlLmluY2x1ZGVzKFwiLlwiKSB8fCBlLmluY2x1ZGVzKFwiW1wiKSA/IHZvaWQgMCA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2V9YCkpID8/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZSkgPz8gdm9pZCAwO1xufVxuZXhwb3J0IHtcbiAgcCBhcyBhLFxuICBQIGFzIGIsXG4gIEggYXMgYyxcbiAgTCBhcyBkLFxuICBPIGFzIGUsXG4gIHggYXMgZixcbiAgTiBhcyBpLFxuICB1IGFzIHAsXG4gIFMgYXMgclxufTtcbiIsImltcG9ydCB7IGRldlRvb2xzQXdhcmVUaW1lb3V0IGFzIGQgfSBmcm9tIFwiQGFyY2dpcy9jb21wb25lbnRzLXV0aWxzXCI7XG4vKiEgQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMi9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG52NC4zMi4xICovXG5mdW5jdGlvbiBhKGkpIHtcbiAgaS5lbC5jaGlsZEVsZW0gPyBpLmVsLmlzQ29ubmVjdGVkIHx8IChpLnZpZXc/LnVpID8gaS52aWV3LnVpLnJlbW92ZShpLmVsLmNoaWxkRWxlbSkgOiBpLndpZGdldD8udmlldyAmJiBpLndpZGdldC52aWV3LnVpLnJlbW92ZShpLmVsLmNoaWxkRWxlbSksIGkuX3dhdGNoSGFuZGxlcyAmJiBpLl93YXRjaEhhbmRsZXMuZm9yRWFjaCgobykgPT4ge1xuICAgIG8ucmVtb3ZlKCk7XG4gIH0pLCBpLl93YXRjaEhhbmRsZXMgPSBbXSwgaS53aWRnZXQ/LmRlc3Ryb3koKSkgOiBkKCgpID0+IHtcbiAgICBpLmVsLmlzQ29ubmVjdGVkIHx8IChpLnZpZXc/LnVpID8gaS52aWV3LnVpLnJlbW92ZShpLmVsKSA6IGkud2lkZ2V0Py52aWV3ICYmIGkud2lkZ2V0LnZpZXcudWkucmVtb3ZlKGkuZWwpLCBpLl93YXRjaEhhbmRsZXMgJiYgaS5fd2F0Y2hIYW5kbGVzLmZvckVhY2goKG8pID0+IHtcbiAgICAgIG8ucmVtb3ZlKCk7XG4gICAgfSksIGkuX3dhdGNoSGFuZGxlcyA9IFtdLCBpLndpZGdldD8uZGVzdHJveSgpKTtcbiAgfSwgMWUzKTtcbn1cbmV4cG9ydCB7XG4gIGEgYXMgb1xufTtcbiIsImltcG9ydCB7IGMgYXMgZSB9IGZyb20gXCIuLi8uLi9jaHVua3MvcnVudGltZS5qc1wiO1xuaW1wb3J0IHsgcmVmIGFzIG8gfSBmcm9tIFwibGl0LWh0bWwvZGlyZWN0aXZlcy9yZWYuanNcIjtcbmltcG9ydCBzIGZyb20gXCJAYXJjZ2lzL2NvcmUvd2lkZ2V0cy9VdGlsaXR5TmV0d29ya1ZhbGlkYXRlVG9wb2xvZ3kuanNcIjtcbmltcG9ydCB7IGQgYXMgYSwgYSBhcyByLCByIGFzIGwgfSBmcm9tIFwiLi4vLi4vY2h1bmtzL2NvbXBvbmVudC11dGlscy5qc1wiO1xuaW1wb3J0IHsgbyBhcyBoIH0gZnJvbSBcIi4uLy4uL2NodW5rcy9kaXNjb25uZWN0ZWQuanNcIjtcbmltcG9ydCB7IGh0bWwgYXMgZCB9IGZyb20gXCJsaXRcIjtcbmltcG9ydCB7IExpdEVsZW1lbnQgYXMgbiwgY3JlYXRlRXZlbnQgYXMgYywgbm9TaGFkb3dSb290IGFzIHcgfSBmcm9tIFwiQGFyY2dpcy9sdW1pbmFcIjtcbi8qISBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVzcmksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMyL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbnY0LjMyLjEgKi9cbmNsYXNzIG0gZXh0ZW5kcyBuIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoLi4uYXJndW1lbnRzKSwgdGhpcy5fd2F0Y2hIYW5kbGVzID0gW10sIHRoaXMuZXh0ZW50VG9WYWxpZGF0ZSA9IFwiY3VycmVudFwiLCB0aGlzLnBvc2l0aW9uID0gXCJib3R0b20tbGVmdFwiLCB0aGlzLmFyY2dpc1JlYWR5ID0gYygpO1xuICB9XG4gIHN0YXRpYyB7XG4gICAgdGhpcy5wcm9wZXJ0aWVzID0geyBleHRlbnRUb1ZhbGlkYXRlOiAxLCBwb3NpdGlvbjogMSwgcmVmZXJlbmNlRWxlbWVudDogMSwgdXRpbGl0eU5ldHdvcms6IDAsIHZpZXc6IDAsIHdpZGdldDogMCB9O1xuICB9XG4gIHN0YXRpYyB7XG4gICAgdGhpcy5zaGFkb3dSb290T3B0aW9ucyA9IHc7XG4gIH1cbiAgLy8gI2VuZHJlZ2lvblxuICAvLyAjcmVnaW9uIExpZmVjeWNsZVxuICB3aWxsVXBkYXRlKHQpIHtcbiAgICB0LmhhcyhcInJlZmVyZW5jZUVsZW1lbnRcIikgJiYgdGhpcy5yZWZlcmVuY2VFbGVtZW50V2F0Y2hlcih0aGlzLnJlZmVyZW5jZUVsZW1lbnQpLCB0LmhhcyhcImV4dGVudFRvVmFsaWRhdGVcIikgJiYgdGhpcy5leHRlbnRUb1ZhbGlkYXRlV2F0Y2hlcih0aGlzLmV4dGVudFRvVmFsaWRhdGUpLCB0LmhhcyhcInV0aWxpdHlOZXR3b3JrXCIpICYmIHRoaXMudXRpbGl0eU5ldHdvcmtXYXRjaGVyKHRoaXMudXRpbGl0eU5ldHdvcmspLCB0LmhhcyhcInBvc2l0aW9uXCIpICYmIHRoaXMucG9zaXRpb25XYXRjaGVyKHRoaXMucG9zaXRpb24pLCB0LmhhcyhcInZpZXdcIikgJiYgdGhpcy52aWV3V2F0Y2hlcih0aGlzLnZpZXcpO1xuICB9XG4gIGFzeW5jIGxvYWRlZCgpIHtcbiAgICBjb25zdCB0ID0gdGhpcy5fY3JlYXRlUGFyYW1zKCksIGkgPSBuZXcgcyh0KTtcbiAgICB0aGlzLndpZGdldCA9IGksIHRoaXMuX2FkZENvbnRhaW5lcigpLCBhKHRoaXMpLCByKHRoaXMpO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHN1cGVyLmRpc2Nvbm5lY3RlZENhbGxiYWNrKCksIGgodGhpcyk7XG4gIH1cbiAgLy8gI2VuZHJlZ2lvblxuICAvLyAjcmVnaW9uIFByaXZhdGUgTWV0aG9kc1xuICByZWZlcmVuY2VFbGVtZW50V2F0Y2hlcih0KSB7XG4gICAgbCh0aGlzLCB0KTtcbiAgfVxuICBleHRlbnRUb1ZhbGlkYXRlV2F0Y2hlcih0KSB7XG4gICAgdGhpcy53aWRnZXQgJiYgKHRoaXMud2lkZ2V0LmV4dGVudFRvVmFsaWRhdGUgPSB0KTtcbiAgfVxuICB1dGlsaXR5TmV0d29ya1dhdGNoZXIodCkge1xuICAgIHRoaXMud2lkZ2V0ICYmIHQgJiYgKHRoaXMud2lkZ2V0LnV0aWxpdHlOZXR3b3JrID0gdCk7XG4gIH1cbiAgcG9zaXRpb25XYXRjaGVyKHQpIHtcbiAgICB0ICE9PSB2b2lkIDAgJiYgdGhpcy53aWRnZXQgJiYgdGhpcy5lbC5jaGlsZEVsZW0gJiYgdGhpcy52aWV3LnVpPy5tb3ZlKHRoaXMuZWwuY2hpbGRFbGVtLCB0KTtcbiAgfVxuICB2aWV3V2F0Y2hlcih0KSB7XG4gICAgdCAhPT0gdm9pZCAwICYmIHRoaXMud2lkZ2V0ICYmICh0aGlzLndpZGdldC52aWV3ID0gdCwgdGhpcy5fbG9hZFV0aWxpdHlOZXR3b3JrKCkpO1xuICB9XG4gIF9hZGRDb250YWluZXIoKSB7XG4gICAgdGhpcy53aWRnZXQuY29udGFpbmVyID0gdGhpcy5lbC5jaGlsZEVsZW07XG4gIH1cbiAgX2NyZWF0ZVBhcmFtcygpIHtcbiAgICBjb25zdCB0ID0ge307XG4gICAgcmV0dXJuIHRoaXMuZXh0ZW50VG9WYWxpZGF0ZSAhPT0gdm9pZCAwICYmICh0LmV4dGVudFRvVmFsaWRhdGUgPSB0aGlzLmV4dGVudFRvVmFsaWRhdGUpLCB0aGlzLnV0aWxpdHlOZXR3b3JrICE9PSB2b2lkIDAgJiYgKHQudXRpbGl0eU5ldHdvcmsgPSB0aGlzLnV0aWxpdHlOZXR3b3JrKSwgdDtcbiAgfVxuICBhc3luYyBfbG9hZFV0aWxpdHlOZXR3b3JrKCkge1xuICAgIGlmICh0aGlzLnZpZXc/Lm1hcCAmJiB0aGlzLnZpZXcubWFwLnBvcnRhbEl0ZW0pIHtcbiAgICAgIGF3YWl0IHRoaXMudmlldy5tYXAubG9hZCgpO1xuICAgICAgY29uc3QgdCA9IHRoaXMudmlldy5tYXAudXRpbGl0eU5ldHdvcmtzPy5nZXRJdGVtQXQoMCk7XG4gICAgICBhd2FpdCB0Py5sb2FkKCksIHRoaXMudXRpbGl0eU5ldHdvcmsgPSB0O1xuICAgIH1cbiAgfVxuICBfc2V0Q2hpbGRFbGVtZW50KHQpIHtcbiAgICB0aGlzLmVsLmNoaWxkRWxlbSA9IHQ7XG4gIH1cbiAgLy8gI2VuZHJlZ2lvblxuICAvLyAjcmVnaW9uIFJlbmRlcmluZ1xuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIGRgPGRpdiAke28odGhpcy5fc2V0Q2hpbGRFbGVtZW50KX0+PC9kaXY+YDtcbiAgfVxufVxuZShcImFyY2dpcy11dGlsaXR5LW5ldHdvcmstdmFsaWRhdGUtdG9wb2xvZ3lcIiwgbSk7XG5leHBvcnQge1xuICBtIGFzIEFyY2dpc1V0aWxpdHlOZXR3b3JrVmFsaWRhdGVUb3BvbG9neVxufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==